<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.profit.persist.mapper.stock.DailyMapper">

    <select id="selectByCode" resultType="org.profit.persist.domain.stock.Daily">
        select * from stock_daily where code=#{code} and day BETWEEN #{begin} and #{end} order by day DESC
    </select>

    <select id="selectLastObj" resultType="org.profit.persist.domain.stock.Daily">
        select * from stock_daily where code=#{code} and day=#{day}
    </select>

    <insert id="insert">
		insert into stock_daily (
			code, day, open, close, high, low, volume, adj
		) values (
			#{code}, #{day}, #{open}, #{close}, #{high},
			#{low}, #{volume}, #{adj}
		)
	</insert>

	<insert id="insertList" parameterType="java.util.List">
		insert into stock_daily (
			code, day, open, close, high, low, volume, adj
		) values
		<foreach collection="list" item="item" index="index" open="(" separator="),(" close=")">
			#{item.code}, #{item.day}, #{item.open}, #{item.close}, #{item.high},
			#{item.low}, #{item.volume}, #{item.adj}
		</foreach>
	</insert>

</mapper>